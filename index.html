<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ì–æ—Ä–æ–¥—Å—å–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∞</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: #121212;
      color: #ffffff;
      transition: background-color 0.3s, color 0.3s;
    }

    body.light-theme {
      background-color: #ffffff;
      color: #121212;
    }

    .loader-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: #FFD500;
      color: black;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 1000;
    }

    .loader-logo {
      width: 260px;
      max-width: 80%;
      height: auto;
      margin-bottom: 24px;
      transition: transform 0.3s ease-in-out;
    }

    .loader {
      margin-top: 24px;
      border: 4px solid #f3f3f3;
      border-radius: 50%;
      border-top: 4px solid #555;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .app {
      display: none;
      flex-direction: column;
      height: 100vh;
    }

    .map-container iframe {
      border: none;
      width: 100%;
      height: 250px;
    }

    .section {
      padding: 16px;
      background-color: #1e1e1e;
      border-top: 1px solid #333;
    }

    body.light-theme .section {
      background-color: #f4f4f4;
      color: #121212;
    }

    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      border-radius: 8px;
      border: 1px solid #444;
      background-color: #2a2a2a;
      color: #fff;
      font-size: 14px;
    }

    body.light-theme input,
    body.light-theme textarea,
    body.light-theme select {
      background-color: #ffffff;
      color: #121212;
      border-color: #ccc;
    }

    .btn {
      width: 100%;
      padding: 12px;
      margin-top: 16px;
      border: none;
      border-radius: 12px;
      background: linear-gradient(145deg, #9b59b6, #8e44ad);
      color: white;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      transition: all 0.2s ease-in-out;
    }

    .btn:hover {
      background: linear-gradient(145deg, #8e44ad, #732d91);
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: #333;
    }

    .btn-secondary:hover {
      background: #444;
    }

    .bottom-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background-color: #1e1e1e;
      border-top: 1px solid #333;
      position: fixed;
      bottom: 0;
      width: 100%;
      z-index: 999;
    }

    body.light-theme .bottom-nav {
      background-color: #f4f4f4;
    }

    .nav-item {
      flex: 1;
      text-align: center;
      color: #ccc;
      font-size: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      transition: color 0.3s ease, transform 0.3s ease;
    }

    .nav-item:hover {
      color: #ffffff;
      transform: translateY(-2px);
    }

    body.light-theme .nav-item:hover {
      color: #000;
    }

    .nav-item.active {
      color: #fff;
      font-weight: bold;
    }

    body.light-theme .nav-item.active {
      color: #000;
    }

    .nav-center-btn {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background-color: #8e44ad;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      top: -28px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
      z-index: 100;
      transition: transform 0.6s ease-in-out;
    }

    .nav-center-btn:hover {
      transform: rotate(360deg);
    }

    .plus-btn {
      color: white;
      font-size: 32px;
      font-weight: bold;
    }

    .profile, .tariffs, .edit-profile-section,
    .support-section, .courier-section, .admin-section {
      display: none;
      padding: 16px;
    }

    .profile-circle img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      margin: auto;
      display: block;
    }

    .phone-number {
      margin-top: 10px;
      font-size: 16px;
      text-align: center;
    }

    .profile-actions div, .tariff-item {
      padding: 10px 0;
      border-bottom: 1px solid #333;
      cursor: pointer;
      color: #bb86fc;
    }

    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1001;
    }

    .modal-content {
      background-color: #1e1e1e;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
      width: 80%;
      max-width: 300px;
    }

    body.light-theme .modal-content {
      background-color: #fff;
    }

    .modal-content h3 {
      margin-bottom: 16px;
    }

    .history {
      padding: 16px;
      background-color: #1e1e1e;
      color: #ffffff;
    }

    body.light-theme .history {
      background-color: #f4f4f4;
      color: #121212;
    }

    .history h3 {
      margin-bottom: 12px;
    }

    .history ul {
      list-style: none;
      padding: 0;
    }

    .history li {
      padding: 10px;
      border-bottom: 1px solid #333;
    }

    .continue-btn {
      position: relative;
      margin: 16px 0;
      z-index: 1;
    }

    .input-group {
      margin-bottom: 16px;
    }

    .input-group label {
      font-size: 14px;
      color: #ccc;
      margin-bottom: 6px;
      display: block;
    }

    body.light-theme .input-group label {
      color: #666;
    }

    .input-with-icon {
      position: relative;
    }

    .input-with-icon input,
    .input-with-icon textarea {
      width: 100%;
      padding: 12px 36px 12px 12px;
      border-radius: 10px;
      border: 1px solid #333;
      background-color: #2a2a2a;
      color: #fff;
      font-size: 14px;
    }

    body.light-theme .input-with-icon input,
    body.light-theme .input-with-icon textarea {
      background-color: #ffffff;
      color: #121212;
      border-color: #ccc;
    }

    .input-with-icon .icon {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: #bb86fc;
      font-size: 18px;
    }

    #payment-section {
      background-color: #2a2a2a;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
      transition: all 0.3s ease;
    }

    body.light-theme #payment-section {
      background-color: #f4f4f4;
    }

    #payment-section h3 {
      font-size: 26px;
      font-weight: bold;
      color: #ffffff;
      text-align: center;
    }

    body.light-theme #payment-section h3 {
      color: #121212;
    }

    #payment-section p {
      font-size: 18px;
      color: #ffffff;
      margin-top: 12px;
      text-align: center;
    }

    body.light-theme #payment-section p {
      color: #121212;
    }

    .order-status {
      padding: 20px;
      text-align: center;
      display: none;
    }

    .status-icon {
      font-size: 50px;
      margin-bottom: 20px;
    }

    .courier-info {
      margin-top: 20px;
      padding: 15px;
      background-color: #333;
      border-radius: 10px;
    }

    body.light-theme .courier-info {
      background-color: #e0e0e0;
    }

    .social-icons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }

    .social-icon {
      font-size: 30px;
      color: #bb86fc;
    }

    .admin-panel {
      display: none;
    }

    .stats-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }

    .stat-card {
      flex: 1;
      min-width: 120px;
      padding: 15px;
      background-color: #333;
      border-radius: 10px;
      text-align: center;
    }

    body.light-theme .stat-card {
      background-color: #e0e0e0;
    }

    .stat-value {
      font-size: 24px;
      font-weight: bold;
      margin: 10px 0;
    }

    .courier-registration {
      display: none;
      padding: 20px;
    }

    .hidden {
      display: none;
    }

    .active-order {
      background-color: #8e44ad;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 15px;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <div class="loader-screen" id="loader">
    <img src="../img/logotip.jpg" alt="Logo" class="loader-logo"/>
    <div>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
    <div class="loader"></div>
  </div>

  <div class="app" id="app">
    <!-- Order Section -->
    <div id="order-section">
      <div class="map-container">
        <iframe src="https://www.google.com/maps/embed?..." allowfullscreen loading="lazy"></iframe>
      </div>
      <div class="section">
        <div class="input-group">
          <label for="delivery-address">–ö—É–¥–∏ –¥–æ—Å—Ç–∞–≤–∏—Ç–∏?</label>
          <div class="input-with-icon">
            <input type="text" id="delivery-address" placeholder="–≤—É–ª. –ö–∏—ó–≤—Å—å–∫–∞, 20" />
            <span class="icon">üìç</span>
          </div>
        </div>

        <div class="input-group">
          <label for="order-desc">–©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏–¥–±–∞—Ç–∏?</label>
          <div class="input-with-icon">
            <textarea id="order-desc" rows="5" placeholder="–û–ø–∏—à—ñ—Ç—å, —â–æ —Å–∞–º–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∫—É–ø–∏—Ç–∏, –¥–µ —ñ —è–∫...&#10;–ù–∞–ø—Ä–∏–∫–ª–∞–¥:&#10;–£–≤–∞–∂–∞–µ–º—ã–π –∫—É—Ä—å–µ—Ä, —Å—ä–µ–∑–¥–∏—Ç–µ –≤ –ê–¢–ë (—Ü–µ–Ω—Ç—Ä) –∏–ª–∏ —Ä–∞–π–æ–Ω, –≤–æ–∑—å–º–∏—Ç–µ –≤—Å–µ –ø–æ –¥–∞–Ω–Ω–æ–º—É —Å–ø–∏—Å–∫—É.&#10;–°–ø–∏—Å–æ–∫:&#10;1. –ë—É—Ä—è–∫&#10;2. –ú–∞—Ä–∫–æ–≤—å&#10;3. –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å&#10;4. –ö–ª–±–∞—Å–∫–∏&#10;5. –°—ã—Ä–∞ –∫–æ–Ω—å—è—á–∫—É"></textarea>
            <span class="icon">üìù</span>
          </div>
        </div>

        <button class="btn continue-btn" id="continue-btn">–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏</button>
      </div>
    </div>

    <!-- Payment Section -->
    <div class="section" id="payment-section">
      <h3>–û–ø–ª–∞—Ç–∞</h3>
      <p>–í–∞—Ä—Ç—ñ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏: <strong>80 –≥—Ä–Ω</strong></p>

      <div class="input-group">
        <label>–í–∏–±–µ—Ä—ñ—Ç—å —Å–ø–æ—Å—ñ–± –æ–ø–ª–∞—Ç–∏:</label>
        <div style="display: flex; align-items: center; margin-top: 10px; gap: 20px;">
          <label>
            <input type="radio" name="payment-method" value="cash" checked /> –ì–æ—Ç—ñ–≤–∫–∞
          </label>
          <label>
            <input type="radio" name="payment-method" value="card" /> –ö–∞—Ä—Ç–∫–∞
          </label>
        </div>
      </div>

      <button class="btn" id="confirm-payment-btn">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –æ–ø–ª–∞—Ç—É</button>
      <button class="btn btn-secondary" id="cancel-order-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>

    <!-- Order Status Section -->
    <div class="order-status" id="order-status-section">
      <div class="status-icon">üîÑ</div>
      <h3>–®—É–∫–∞—î–º–æ –∫—É—Ä'—î—Ä–∞...</h3>
      <p>–í–∞—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è</p>

      <div class="courier-info hidden" id="courier-info">
        <h4>–í–∞—à –∫—É—Ä'—î—Ä:</h4>
        <p id="courier-name">–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ</p>
        <p id="courier-phone">+380 99 123 4567</p>
        <p id="courier-rating">–†–µ–π—Ç–∏–Ω–≥: 4.9 ‚òÖ</p>

        <div class="action-buttons">
          <button class="btn" id="chat-with-courier">–ß–∞—Ç –∑ –∫—É—Ä'—î—Ä–æ–º</button>
          <button class="btn btn-secondary" id="cancel-active-order">–°–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
        </div>
      </div>
    </div>

    <!-- Tariffs Section -->
    <div class="tariffs" id="tariffs">
      <h3>–¢–∞—Ä–∏—Ñ–∏ –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É</h3>
      <div class="tariff-item">–ú—ñ—Å—Ç–æ ‚Äî 75 –≥—Ä–Ω</div>
      <div class="tariff-item">–û–∫–æ–ª–∏—Ü—ñ ‚Äî 120 –≥—Ä–Ω</div>
      <div class="tariff-item">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è ‚Äî 10 –≥—Ä–Ω/10 —Ö–≤</div>

      <h3 style="margin-top: 30px;">–ù–∞—à—ñ —Å–æ—Ü—ñ–∞–ª—å–Ω—ñ –º–µ—Ä–µ–∂—ñ</h3>
      <div class="social-icons">
        <a href="https://t.me/yourchannel" class="social-icon">üì¢</a>
        <a href="https://instagram.com/yourpage" class="social-icon">üì∑</a>
      </div>
    </div>

    <!-- Profile Section -->
    <div class="profile" id="profile">
      <div class="profile-circle"><img id="user-photo" src="" alt="User Photo"></div>
      <div class="phone-number" id="user-name"></div>
      <div class="phone-number" id="user-phone"></div>

      <div class="profile-actions">
        <div id="edit-profile">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é</div>
        <div id="toggle-theme">üåì –ó–º—ñ–Ω–∏—Ç–∏ —Ç–µ–º—É</div>
        <div id="view-tariffs">üí∞ –¢–∞—Ä–∏—Ñ–∏</div>
        <div id="contact-support">üõü –ó–≤'—è–∑–æ–∫ –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é</div>

        <h3 style="margin-top: 20px;">–Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–º–æ–≤–ª–µ–Ω—å</h3>
        <div id="view-history">üìã –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ—Å—Ç–æ—Ä—ñ—é</div>

        <h3 style="margin-top: 20px;">–ú–æ—ó –∞–¥—Ä–µ—Å–∏</h3>
        <div id="add-address">‚ûï –î–æ–¥–∞—Ç–∏ –∞–¥—Ä–µ—Å—É</div>

        <!-- Admin/Courier Access -->
        <div id="courier-access" class="hidden">üöó –†–µ–∂–∏–º –∫—É—Ä'—î—Ä–∞</div>
        <div id="admin-access" class="hidden">üëë –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å</div>
      </div>
    </div>

    <!-- Edit Profile Section -->
    <div class="edit-profile-section" id="edit-profile-section">
      <h3>–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é</h3>
      <div class="input-group">
        <label for="new-name">–Ü–º'—è</label>
        <input type="text" id="new-name" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ —ñ–º'—è" />
      </div>

      <div class="input-group">
        <label for="new-phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
        <input type="tel" id="new-phone" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω" />
      </div>

      <button class="btn" id="save-profile">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      <button class="btn btn-secondary" onclick="showSection('profile')">–ù–∞–∑–∞–¥</button>
    </div>

    <!-- Support Section -->
    <div class="support-section" id="support-section">
      <h3>–ó–≤'—è–∑–æ–∫ –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é</h3>
      <p>–Ø–∫—â–æ —É –≤–∞—Å –≤–∏–Ω–∏–∫–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è –∞–±–æ –ø—Ä–æ–±–ª–µ–º–∏, –Ω–∞–ø–∏—à—ñ—Ç—å –Ω–∞–º:</p>

      <div class="input-group">
        <label for="support-message">–í–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</label>
        <textarea id="support-message" rows="5" placeholder="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É..."></textarea>
      </div>

      <button class="btn" id="send-support-message">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
      <button class="btn btn-secondary" onclick="showSection('profile')">–ù–∞–∑–∞–¥</button>
    </div>

    <!-- History Section -->
    <div class="history" id="history">
      <h3>–Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–º–æ–≤–ª–µ–Ω—å</h3>
      <ul id="history-list">
        <!-- Will be populated dynamically -->
      </ul>
      <button class="btn btn-secondary" onclick="showSection('profile')">–ù–∞–∑–∞–¥</button>
    </div>

    <!-- Courier Section -->
    <div class="courier-section" id="courier-section">
      <h3>–†–µ–∂–∏–º –∫—É—Ä'—î—Ä–∞</h3>
      <div id="active-orders">
        <h4>–ê–∫—Ç–∏–≤–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h4>
        <div id="orders-list">
          <!-- Will be populated dynamically -->
        </div>
      </div>

      <div id="no-orders" class="hidden">
        <p>–ù–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å</p>
      </div>

      <button class="btn btn-secondary" onclick="showSection('profile')">–ù–∞–∑–∞–¥</button>
    </div>

    <!-- Admin Section -->
    <div class="admin-section" id="admin-section">
      <h3>–ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å</h3>

      <div class="stats-container">
        <div class="stat-card">
          <div>–°—å–æ–≥–æ–¥–Ω—ñ</div>
          <div class="stat-value">12</div>
          <div>–∑–∞–º–æ–≤–ª–µ–Ω—å</div>
        </div>

        <div class="stat-card">
          <div>–ó–∞ —Ç–∏–∂–¥–µ–Ω—å</div>
          <div class="stat-value">84</div>
          <div>–∑–∞–º–æ–≤–ª–µ–Ω—å</div>
        </div>

        <div class="stat-card">
          <div>–ó–∞ –º—ñ—Å—è—Ü—å</div>
          <div class="stat-value">356</div>
          <div>–∑–∞–º–æ–≤–ª–µ–Ω—å</div>
        </div>
      </div>

      <div class="input-group" style="margin-top: 20px;">
        <button class="btn" id="manage-couriers">–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫—É—Ä'—î—Ä–∞–º–∏</button>
        <button class="btn" id="view-all-orders">–ü–µ—Ä–µ–≥–ª—è–¥ —É—Å—ñ—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å</button>
        <button class="btn btn-secondary" onclick="showSection('profile')">–ù–∞–∑–∞–¥</button>
      </div>
    </div>

    <!-- Courier Registration -->
    <div class="courier-registration" id="courier-registration">
      <h3>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫—É—Ä'—î—Ä–∞</h3>
      <p>–î–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —è–∫ –∫—É—Ä'—î—Ä, –≤–≤–µ–¥—ñ—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø—É:</p>

      <div class="input-group">
        <label for="courier-code">–ö–æ–¥ –¥–æ—Å—Ç—É–ø—É</label>
        <input type="password" id="courier-code" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫–æ–¥ –¥–æ—Å—Ç—É–ø—É" />
      </div>

      <button class="btn" id="register-as-courier">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
      <button class="btn btn-secondary" onclick="showSection('profile')">–ù–∞–∑–∞–¥</button>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
      <div class="nav-item active" onclick="showSection('history', this)">
        <div class="nav-icon">üóíÔ∏è</div>
        <div class="nav-label">–Ü—Å—Ç–æ—Ä—ñ—è</div>
      </div>
      <div class="nav-center-btn" onclick="showSection('order-section', this)">
        <div class="plus-btn">+</div>
      </div>
      <div class="nav-item" onclick="showSection('profile', this)">
        <div class="nav-icon">üë§</div>
        <div class="nav-label">–ü—Ä–æ—Ñ—ñ–ª—å</div>
      </div>
    </div>
  </div>

  <!-- Modal for Address -->
  <div class="modal" id="address-modal" style="display: none;">
    <div class="modal-content">
      <h3>–î–æ–¥–∞—Ç–∏ –∞–¥—Ä–µ—Å—É</h3>
      <input type="text" id="new-address" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à—É –∞–¥—Ä–µ—Å—É" />
      <button class="btn" onclick="saveAddress()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
      <button class="btn btn-secondary" onclick="closeModal()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    // Initialize user data
    let userData = {
      name: '',
      phone: '',
      photo: '',
      isCourier: false,
      isAdmin: false,
      addresses: [],
      orders: []
    };

    // Simulated courier data
    const couriers = [
      { id: 1, name: "–Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ", phone: "+380991234567", rating: 4.9 },
      { id: 2, name: "–û–ª–µ–∫—Å—ñ–π –°–∏–¥–æ—Ä–µ–Ω–∫–æ", phone: "+380671234567", rating: 4.8 }
    ];

    // Sample orders data
    const sampleOrders = [
      { id: 1, date: "20.05.2025", address: "–≤—É–ª. –ö–∏—ó–≤—Å—å–∫–∞, 20", items: "–ë—É—Ä—è–∫, –ú–∞—Ä–∫–æ–≤—å, –ö–∞—Ä—Ç–æ—Ñ–µ–ª—å", status: "–í–∏–∫–æ–Ω–∞–Ω–æ", price: "80 –≥—Ä–Ω" },
      { id: 2, date: "19.05.2025", address: "–≤—É–ª. –®–µ–≤—á–µ–Ω–∫–∞, 15", items: "–•–ª—ñ–±, –ú–æ–ª–æ–∫–æ, –Ø–π—Ü—è", status: "–í–∏–∫–æ–Ω–∞–Ω–æ", price: "75 –≥—Ä–Ω" }
    ];

    // Initialize the app
    window.addEventListener("load", () => {
      document.getElementById("loader").style.display = "none";
      document.getElementById("app").style.display = "flex";

      // Initialize user data from Telegram
      if (tg.initDataUnsafe?.user) {
        const user = tg.initDataUnsafe.user;
        userData.name = user.first_name + (user.last_name ? ' ' + user.last_name : '');
        userData.photo = user.photo_url || '';

        // Request phone number if not available
        if (!user.phone_number) {
          tg.requestContact((contact) => {
            userData.phone = contact.phone_number;
            updateProfileDisplay();
          });
        } else {
          userData.phone = user.phone_number;
        }

        updateProfileDisplay();
      }

      // Load sample data
      userData.orders = sampleOrders;
      populateHistory();

      // Show order section by default
      showSection("order-section");
    });

    // Update profile display
    function updateProfileDisplay() {
      document.getElementById("user-name").textContent = userData.name;
      document.getElementById("user-phone").textContent = userData.phone || '–¢–µ–ª–µ—Ñ–æ–Ω –Ω–µ –≤–∫–∞–∑–∞–Ω–æ';

      if (userData.photo) {
        document.getElementById("user-photo").src = userData.photo;
      }

      // Show/hide admin/courier access
      if (userData.isAdmin) {
        document.getElementById("admin-access").classList.remove("hidden");
      }
      if (userData.isCourier) {
        document.getElementById("courier-access").classList.remove("hidden");
      }
    }

    // Show specific section
    function showSection(id, element) {
      const sections = [
        "order-section", "payment-section", "order-status-section",
        "tariffs", "profile", "edit-profile-section", "support-section",
        "history", "courier-section", "admin-section", "courier-registration"
      ];

      sections.forEach(s => {
        const el = document.getElementById(s);
        if (el) el.style.display = "none";
      });

      const targetSection = document.getElementById(id);
      if (targetSection) targetSection.style.display = "block";

      // Update active nav item
      const navItems = document.querySelectorAll(".nav-item");
      navItems.forEach(el => el.classList.remove("active"));

      if (element?.classList.contains("nav-item")) {
        element.classList.add("active");
      }
    }

    // Populate history list
    function populateHistory() {
      const historyList = document.getElementById("history-list");
      historyList.innerHTML = '';

      userData.orders.forEach(order => {
        const li = document.createElement("li");
        li.innerHTML = `
          <strong>${order.date}</strong><br>
          <span>${order.address}</span><br>
          <span>${order.items}</span><br>
          <span>${order.price} - ${order.status}</span>
        `;
        historyList.appendChild(li);
      });
    }

    // Event listeners
    document.getElementById("continue-btn").addEventListener("click", () => {
      const address = document.getElementById("delivery-address").value;
      const description = document.getElementById("order-desc").value;

      if (!address || !description) {
        alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è");
        return;
      }

      showSection("payment-section");
    });

    document.getElementById("confirm-payment-btn").addEventListener("click", () => {
      const address = document.getElementById("delivery-address").value;
      const description = document.getElementById("order-desc").value;
      const paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;

      // Create new order
      const newOrder = {
        id: Date.now(),
        date: new Date().toLocaleDateString(),
        address: address,
        items: description.split('\n')[0], // First line as summary
        status: "–í –æ–±—Ä–æ–±—Ü—ñ",
        price: "80 –≥—Ä–Ω",
        payment: paymentMethod === 'cash' ? '–ì–æ—Ç—ñ–≤–∫–∞' : '–ö–∞—Ä—Ç–∫–∞'
      };

      // Add to history
      userData.orders.unshift(newOrder);
      populateHistory();

      // Show order status
      showSection("order-status-section");

      // Simulate finding a courier after 3 seconds
      setTimeout(() => {
        const courierInfo = document.getElementById("courier-info");
        const courier = couriers[Math.floor(Math.random() * couriers.length)];

        document.getElementById("courier-name").textContent = courier.name;
        document.getElementById("courier-phone").textContent = courier.phone;
        document.getElementById("courier-rating").textContent = `–†–µ–π—Ç–∏–Ω–≥: ${courier.rating} ‚òÖ`;

        courierInfo.classList.remove("hidden");
        document.querySelector(".status-icon").textContent = "üõµ";
        document.querySelector("#order-status-section h3").textContent = "–ö—É—Ä'—î—Ä –≤ –¥–æ—Ä–æ–∑—ñ";
      }, 3000);
    });

    document.getElementById("cancel-order-btn").addEventListener("click", () => {
      showSection("order-section");
    });

    document.getElementById("cancel-active-order").addEventListener("click", () => {
      if (confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ —Å–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?")) {
        showSection("order-section");
      }
    });

    document.getElementById("chat-with-courier").addEventListener("click", () => {
      tg.openTelegramLink(`https://t.me/${tg.initDataUnsafe?.user?.username}`);
    });

    document.getElementById("toggle-theme").addEventListener("click", () => {
      document.body.classList.toggle("light-theme");
    });

    document.getElementById("edit-profile").addEventListener("click", () => {
      document.getElementById("new-name").value = userData.name;
      document.getElementById("new-phone").value = userData.phone;
      showSection("edit-profile-section");
    });

    document.getElementById("save-profile").addEventListener("click", () => {
      const newName = document.getElementById("new-name").value;
      const newPhone = document.getElementById("new-phone").value;

      if (newName.trim()) {
        userData.name = newName;
        userData.phone = newPhone;
        updateProfileDisplay();
        showSection("profile");
      }
    });

    document.getElementById("view-history").addEventListener("click", () => {
      showSection("history");
    });

    document.getElementById("view-tariffs").addEventListener("click", () => {
      showSection("tariffs");
    });

    document.getElementById("contact-support").addEventListener("click", () => {
      showSection("support-section");
    });

    document.getElementById("send-support-message").addEventListener("click", () => {
      const message = document.getElementById("support-message").value;
      if (message.trim()) {
        alert("–í–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ –ø—ñ–¥—Ç—Ä–∏–º–∫—É");
        document.getElementById("support-message").value = "";
        showSection("profile");
      }
    });

    document.getElementById("add-address").addEventListener("click", () => {
      document.getElementById("new-address").value = "";
      document.getElementById("address-modal").style.display = "flex";
    });

    document.getElementById("courier-access").addEventListener("click", () => {
      if (userData.isCourier) {
        showSection("courier-section");
      } else {
        showSection("courier-registration");
      }
    });

    document.getElementById("admin-access").addEventListener("click", () => {
      showSection("admin-section");
    });

    document.getElementById("register-as-courier").addEventListener("click", () => {
      const code = document.getElementById("courier-code").value;
      if (code === "COURIER123") { // Sample access code
        userData.isCourier = true;
        updateProfileDisplay();
        showSection("courier-section");
      } else {
        alert("–ù–µ–≤—ñ—Ä–Ω–∏–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø—É");
      }
    });

    function saveAddress() {
      const address = document.getElementById("new-address").value;
      if (address.trim()) {
        userData.addresses.push(address);
        closeModal();
        alert("–ê–¥—Ä–µ—Å—É –∑–±–µ—Ä–µ–∂–µ–Ω–æ");
      }
    }

    function closeModal() {
      document.getElementById("address-modal").style.display = "none";
    }

    // Simulate courier orders
    function populateCourierOrders() {
      const ordersList = document.getElementById("orders-list");
      ordersList.innerHTML = '';

      if (sampleOrders.length > 0) {
        document.getElementById("no-orders").classList.add("hidden");

        sampleOrders.forEach(order => {
          const div = document.createElement("div");
          div.className = "active-order";
          div.innerHTML = `
            <h4>–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è #${order.id}</h4>
            <p>–ê–¥—Ä–µ—Å–∞: ${order.address}</p>
            <p>–î–µ—Ç–∞–ª—ñ: ${order.items}</p>
            <p>–û–ø–ª–∞—Ç–∞: ${order.payment || '–ì–æ—Ç—ñ–≤–∫–∞'}</p>
            <div class="action-buttons">
              <button class="btn accept-order-btn" data-id="${order.id}">–ü—Ä–∏–π–Ω—è—Ç–∏</button>
            </div>
          `;
          ordersList.appendChild(div);
        });

        // Add event listeners to accept buttons
        document.querySelectorAll(".accept-order-btn").forEach(btn => {
          btn.addEventListener("click", function() {
            const orderId = parseInt(this.getAttribute("data-id"));
            acceptOrder(orderId);
          });
        });
      } else {
        document.getElementById("no-orders").classList.remove("hidden");
      }
    }

    function acceptOrder(orderId) {
      alert(`–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è #${orderId} –ø—Ä–∏–π–Ω—è—Ç–æ!`);
      // In a real app, you would update the order status in the backend
    }

    // Initialize courier orders when courier section is shown
    document.getElementById("courier-section").addEventListener("click", populateCourierOrders);
  </script>
</body>
</html>
